# 复杂度来源 : 高可用

复杂度的第二个来源 , 即高可用 .

> 系统无中断的执行其功能的能力 , 代表系统的可用性程度 , 是进行系统设计时的准则之一 .

定义的关键在"**无中断**" , 难点也在"无中断"上 , 因为无论是单个硬件还是单个软件 , 都不可能无中断 , 硬件会出故障 , 软件会有bug ; 硬件会逐渐老化 , 软件会越来越复杂和庞大 .

当然 , 外部的环境也会导致不可避免的 , 不受控制的中断 . 断电 , 地震等 .

所有 , 系统的高可用方案 , 本质上都是通过"冗余"来实现的 . 通俗点讲 , 一条通道可能故障 , 那就两条 , 两条不够那就三条 , 一台机器不够, 就换两台 , 一个机房断点 , 就部署两个机房 . 这样看来 , 冗余的解决方案和之前的高性能看起来一样 , 但根本的区别是 :

**高性能增加机器目的在于"扩展"处理性能 ; 高可用增加机器目的在于"冗余"处理单元 . **

当然 , 通过冗余增强了可用性 , 但同时也带来了复杂性 .

#### 计算高可用

这里的"计算"指的是业务的逻辑处理 . 计算有一个特点就是**无论在哪台机器上进行计算 , 同样的算法和输入数据 , 产出的结果都是一样的** . 所以将计算从一台机器迁移到另外一台机器 , 对业务并没有什么影响 .

看下面的单机变双机的简单架构示意图 :

![](/assets/danjibianshuangji.png)

这张图和之前的高性能提到的双机架构图是一样的 , 因此其复杂度也是类似的 :

* 需要增加一个任务分配器 , 选择合适的任务分配器也是一件复杂的事情 , 需要综合考虑性能、成本、可维护性、可用性等各方面因素 . 
* 任务分配器和真正的业务服务器之间有连接和交互 , 需要选择合适的连接方式 , 并且对连接进行管理 . 例如 , 连接建立、连接检测、连接中断后如何处理等 . 
* 任务分配器需要增加分配算法 . 例如 , 常见的双机算法有主备、主主 , 主备方案又可以细分为冷备、温备、热备 . 

再看一个**高可用集群架构**

![](/assets/gaokeyongjiqunjiaogou.png)

高可用集群相比双击来说 , 分配算法更加复杂 , 可以是1主3备 , 2主2备 , 3主1备 , 4主0备 , 具体还是需要结合实际业务需求来分析和判断 . 

