# 架构设计的目的

#### 架构设计的误区

* 架构很重要 , 所以要做架构设计
  * 不做架构设计系统就跑步起来么?
    * 创业初期 , 产品没有架构设计 , 也没有正规的架构设计过程 , 但产品的开发速度可能更快 . 
  * 做了架构设计就能提升开发效率么?
    * 有时候最简单的设计开发效率反而是最高的 . 
  * 设计良好的架构能促进业务发展么?
    * 设计高性能的架构能够让用户体验更好 , 但也不代表把微信的架构拿过来用就是好的 . 
* 不是每个系统都要做架构设计吗
  * 反正大家都要做架构设计 , 生搬硬套业界其他公司已有的架构 , 但很有可能水土不服 , 导致不断重构 . 
* 公司流程要求系统开发过程中必须有架构设计
  * 本末倒置 , 因为流程规定而坐架构设计 , 但很多需求并不一定要进行架构设计 . 切勿走形式 .  
* 为了高性能 , 高可用 , 可扩展 , 所以要做架构设计
  * 给出这个答案说明有一定经验 , 但往往也是灾难的开始 , 架构设计复杂无比 , 使得运行很不稳定 . 

#### 架构设计的真正目的

通过回顾架构产生的历史背景和原因 , 得出 :

**架构设计的主要目的是为了解决软件系统复杂度带来的问题 . **

* 这么多需求 , 从哪里开始一下手进行架构设计呢 ? 
  * 通过熟悉和理解需求 , 识别系统复杂性所在的地方 , 然后针对这些复杂点进行架构设计 . 
* 架构设计要考虑高性能 , 高可用 , 高扩展等 ... 
  * 架构设计并不是要面面俱到 , 不需要每个架构都要具备高性能 , 高可用 , 高扩展等特点 , 而是要识别出复杂点 , 然后有针对性的解决问题 . 
* 业界A公司的架构是X , B公司的方案是Y , 两个差别比较大 , 该参考哪一个
  * 理解每个架构方案背后所需要解决的复杂点 , 然后才能对比自己的业务复杂点 , 参考复杂点相似的方案 . 

**切勿贪大求全**

* 我们的系统一定要做到每秒TPS10万
  * 如果系统的复杂度不是在性能这部分 , TPS做到10万并没有什么用
* 淘宝的架构是这么做的 , 我们也要这么做
  * 淘宝的架构是为了解决淘宝业务的复杂度而设计的 , 淘宝的业务复杂度并不是我们的业务复杂度 , 绝大多数业务的用户量都不可能有淘宝那么大 . 
* Docker现在很流行 , 我们的架构应该将Docker应用进来
  * Docker不是万能的 , 只是为了解决资源重用和动态分配而设计的 , 如果我们的系统复杂度根本不是在这方面 , 引入Docker没有什么意义 . 

#### 简单的复杂度分析案例

假设设计一个大学的学生管理系统 , 其基本功能包括登录 , 注册 , 成绩管理 , 课程管理等 . 接下来进行复杂度识别 :

**性能**

一个学校的学生大约1~2万人 , 学生管理系统的访问频率并不高 , 平均每天单个学生的访问次数平均不到1次 , 因此性能这部分并不复杂 , 存储用MySQL完全能够胜任 , 缓存都可以不用 , Web服务器用Nginx绰绰有余 .

**高可用**

学生管理系统即使宕机2小时 , 对学生管理工作影响并不大 , 因此可以不偶负载均衡 , 更不用考虑异地多活这类复杂的方案 . 但是 , 如果学生的数据全部丢失 , 修复是非常麻烦的 , 只能靠人工逐条修复 , 这个很难接受 , 因此需要考虑存储高可靠 , 这里就有点复杂了 . 需要考虑多种异常情况 : 机器故障 , 机房故障 , 针对机器故障 , 需要设计MySQL同机房主备方案 ; 针对机房故障 , 需要设计MySQL跨机房同步方案 . 

**安全性**

学生管理系统存储的信息有一定的隐私性 , 但不是和金融相关的 , 也不包含强隐私的信息 , 因此安全性方面只要做3个事情就基本满足要求了 : Nginx提供ACL控制 , 用户账号密码管理 , 数据库访问权限控制 . 

**成本**

由于系统很简单 , 基本上几台服务器就能够搞定 , 对于一所大学来说完全不是问题 , 可以无需太多关注 . 

**经过分析 , 可以看到这个方案的主要复杂性体现在存储可靠性上 , 需要保证异常的时候 , 不要丢失所有数据即可** : 

![](/assets/xueshengxitong.png)

